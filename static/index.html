<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Cucumber</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  
    <link rel="stylesheet" href="file/stylesheet.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content center" ref="intro/title/1">
<h1>BDD with Cucumber and RSpec</h1>

<p>Marcus Ahnve<br/>
Valtech AB <br/>
<a href="mailto:marcus.ahnve@valtech.se">marcus.ahnve@valtech.se</a><br/>
<a href="http://www.twitter.com/mahnve">@mahnve</a></p>

<p><img src="./file/intro/valtech_logo.jpg" alt="Valtech"/></p></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="intro/title/2">
<h1>About me</h1>

<ul>
<li>Software Developer</li>
<li>Polyglot Programmer</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/title/3">
<h1>Q: How many are using Cucumber</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/title/4">
<h1>Q: How many have heard of Cucumber</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/title/5">
<h1>Q: How many are using RSpec</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/title/6">
<h1>Q: How many have heard of RSpec</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/title/7">
<h1>Q: How many are doing TDD/BDD?</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/title/8">
<h1>Q: How many think I am asking too many questions?</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="intro/title/9">
<h1>My BDD history</h1>

<ul>
<li>Java and Ruby developer</li>
<li>TestDox, Joe Walnes</li>
<li>Dan North</li>
<li>Dave Astels, Aslak Helles&#xF8;y, David Chelimsky</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="intro/title/10">
<pre><code><code class="command">$ rake</code>
<code class="result">
Finished in 27.79 seconds
285 examples, 0 failures

152 scenarios (152 passed)
1363 steps (1363 passed)
4m4.505s

Finished in 8.06 seconds
77 examples, 0 failures
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="tdd_bdd/01_tddbdd/1">
<h1>Why automatic testing?</h1>

<ul>
<li>Make sure it works now</li>
<li>Make sure it works whenever</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="tdd_bdd/01_tddbdd/2">
<h1>Why TDD?</h1>

<ul>
<li>Make sure it works now</li>
<li>Make sure it works whenever</li>
<li>Know when you're done</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code" ref="tdd_bdd/01_tddbdd/3">
<h1>Method Testing</h1>

<pre class="sh_ruby"><code>class Klazz
  def method
    do_something
  end
end

class KlazzTest
  def setup
    @klazz = Klazz.new
  end
  def test_method
    result = @klazz.do_something
    assert_equal("expected", result)
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="tdd_bdd/01_tddbdd/4">
<h1>The Context Problem</h1>

<pre class="sh_ruby"><code>
class KlazzTest
  def setup
    @klazz = Klazz.new
  end
  def test_method
    result = @klazz.do_something
    assert_equal(:expected, result)
  end
  def test_another_context
    klazz = Klazz.new(:constructor_args)
    assert_equal(:expected_2, klazz.do_something)
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="tdd_bdd/01_tddbdd/5">
<h1>Why BDD?</h1>

<ul>
<li>Make sure it works now</li>
<li>Make sure it works whenever</li>
<li>Know when you're done</li>
<li>Build just what's needed</li>
<li>Design from functionality</li>
<li>Documentation - why</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="tdd_bdd/01_tddbdd/6">
<h1>What is BDD?</h1>

<blockquote><p>"BDD is TDD done right"</p>

<p>"TDD means 'write the test first'. BDD takes this idea to a more general
level: 'write the client first' (the outside)" <br/>
- Aslak Helles&#xF8;y</p></blockquote></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="tdd_bdd/01_tddbdd/7">
<h1>The BDD Flow</h1>

<p><img src="./file/tdd_bdd/bdd_flow.svg" alt="BDD Flow"/></p></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/1">
<pre><code><code class="command">$ rails new blog -T</code>
<code class="result">
  create  
  create  README
  create  Rakefile
  create  config.ru
  create  .gitignore
  create  Gemfile
  create  app
  create  app/controllers/application_controller.rb
  ...
  create  vendor/plugins/.gitkeep
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/2">
<pre class="sh_ruby"><code>
source 'http://rubygems.org'

gem 'rails', '3.0.0'
gem 'sqlite3-ruby', :require =&gt; 'sqlite3'

group :test do
  gem 'rspec-rails'
  gem 'cucumber-rails'
  gem 'capybara'
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/3">
<pre><code><code class="command">$ bundle install                                                                   &#x2500;&#x2500;master(Mon,Apr04)&#x2500;&#x2518;</code>
<code class="result">
Fetching source index for http://rubygems.org/
Using rake (0.8.7) 
...
Installing rack (1.2.2) 
Installing rack-mount (0.6.14) 
...
Installing gherkin (2.3.5) with native extensions 
Installing term-ansicolor (1.0.5) 
Installing cucumber (0.10.2) 
Installing cucumber-rails (0.4.0) 
...
Installing rspec (2.5.0) 
Installing rspec-rails (2.5.0) 
Using sqlite3 (1.3.3) 
Using sqlite3-ruby (1.3.3) 
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/4">
<pre><code><code class="command">$ rake db:migrate</code>
</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/5">
<pre><code><code class="command">$ rails generate cucumber:install</code>
<code class="result">
create  config/cucumber.yml
create  script/cucumber
 chmod  script/cucumber
create  features/step_definitions
create  features/step_definitions/web_steps.rb
create  features/support
create  features/support/paths.rb
create  features/support/selectors.rb
create  features/support/env.rb
 exist  lib/tasks
create  lib/tasks/cucumber.rake
  gsub  config/database.yml
  gsub  config/database.yml
 force  config/database.yml
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/6">
<pre><code><code class="command">$ rails generate rspec:install                                                     &#x2500;&#x2500;master(Mon,Apr04)&#x2500;&#x2518;</code>
<code class="result">
create  .rspec
create  spec
create  spec/spec_helper.rb
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/7">
<pre class="sh_cucumber"><code>
Feature: User writes blog post

  In order for other people to read brilliant thoughts
  A user can post a blog post

  Scenario: 

    Given I am on the new blog post page
    When I write a blog post
    And it has the title "My great Idea"
    And it has the body "Body body body"
    And I press "Save"
    Then I should see "My great Idea"</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/8">
<pre><code><code class="command">$ rake</code>
<code class="result">
1 scenario (1 failed)
6 steps (1 failed, 2 skipped, 3 undefined)
0m1.103s

You can implement step definitions for undefined steps with these snippets:
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/9">
<pre class="sh_ruby"><code>
When /^I write a blog post$/ do
  pending # express the regexp above with the code you wish you had
end

When /^it has the title "([^"]*)"$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end

When /^it has the body "([^"]*)"$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="code/01_code/10">
<pre><code>$ rake

Given I am on the new blog post page # features/step_definitions/web_steps.rb:44
Can't find mapping from "the new blog post page" to a path.
Now, go and add a mapping in /home/mahnve/src/presentations/cucumber/src/blog/features/support/paths.rb (RuntimeError)
</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/11">
<pre class="sh_ruby"><code>
module NavigationHelpers
  def path_to(page_name)
    case page_name
    when /the home\s?page/
      '/'
    when /the new blog post page/
      '/blog_posts/new'</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/12">
<pre><code><code class="command">$ rake</code>
<code class="result">
Scenario:  # features/user_writes_blogpost.feature:6
  Given I am on the new blog post page # features/step_definitions/web_steps.rb:44
    No route matches "/blogpost/new" (ActionController::RoutingError)
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/13">
<pre><code><code class="command">$ rails generate resource BlogPost title:string body:string</code>
<code class="result">
invoke  active_record
create    db/migrate/20110404155134_create_blog_posts.rb
create    app/models/blog_post.rb
invoke    test_unit
create      test/unit/blog_post_test.rb
create      test/fixtures/blog_posts.yml
invoke  controller
create    app/controllers/blog_posts_controller.rb
invoke    erb
create      app/views/blog_posts
invoke    test_unit
create      test/functional/blog_posts_controller_test.rb
invoke    helper
create      app/helpers/blog_posts_helper.rb
invoke      test_unit
create        test/unit/helpers/blog_posts_helper_test.rb
 route  resources :blog_posts
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/14">
<pre><code><code class="command">$ rake</code>
<code class="result">
(in /home/mahnve/src/presentations/cucumber/src/blog)
You have 1 pending migrations:
  20110404155134 CreateBlogPosts
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/15">
<pre class="sh_ruby"><code>
class CreateBlogPosts &lt; ActiveRecord::Migration
  def self.up
    create_table :blog_posts do |t|
      t.string :title
      t.string :body

      t.timestamps
    end
  end

  def self.down
    drop_table :blog_posts
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/16">
<pre><code><code class="command">$ rake db:migrate</code>
<code class="result">
(in /home/mahnve/src/presentations/cucumber/src/blog)
==  CreateBlogPosts: migrating ================================================
-- create_table(:blog_posts)
  -&gt; 0.0010s
==  CreateBlogPosts: migrated (0.0010s) =======================================
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/17">
<pre><code><code class="command">$ rake</code>
<code class="result">
Given I am on the new blog post page # features/step_definitions/web_steps.rb:44
The action 'new' could not be found for BlogPostsController (AbstractController::ActionNotFound)
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/18">
<pre class="sh_ruby"><code>
gem 'inherited_resources'</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/19">
<pre class="sh_ruby"><code>
class BlogPostsController &lt; InheritedResources::Base
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/20">
<pre><code><code class="command">$ rake</code>
<code class="result">
Missing template blog_posts/new with ...
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/21">
<pre class="sh_ruby"><code>
gem 'formtastic'
gem 'haml'</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/22">
<pre class="sh_haml"><code>
- semantic_form_for @blog_post do |form|
  = form.inputs
  = form.buttons</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/23">
<pre><code><code class="command">$ rake </code>
<code class="result">
Given I am on the new blog post page # features/step_definitions/web_steps.rb:44
When I write a blog post             # features/step_definitions/blogpost_steps.rb:1
  TODO (Cucumber::Pending)
  ./features/step_definitions/blogpost_steps.rb:2:in `/^I write a blog post$/'
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="code/01_code/24">
<h1>Oops</h1>

<ul>
<li>Steps where not really optimal</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/25">
<pre class="sh_ruby"><code>
When /^I write a blog post with title "([^"]*)" and the body "([^"]*)"$/ do |title, body|
  fill_in 'Title', :with =&gt; title
  fill_in 'Body', :with =&gt; body
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/26">
<pre class="sh_cucumber"><code>
Given I am on the new blog post page
When I write a blog post with title "My great Idea" and body "Body body body"
And I press "Create Blog post"
Then I should see "My great Idea"</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/01_code/27">
<pre><code><code class="command">$ rake</code>
<code class="result">
...
Missing template blog_posts/show
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/01_code/28">
<pre class="sh_haml"><code>
= @blog_post.title</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/02_validations/1">
<pre class="sh_cucumber"><code>
Scenario: Create without title

  Given I am on the new blog post page
  When I write a blog post without a title
  And I press "Create Blog post"
  Then I should see "can't be blank"</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/02_validations/2">
<pre><code><code class="command">$ rake</code>
<code class="result">
 Then I should see "Required"              # features/step_definitions/web_steps.rb:105
  expected #has_content?("Required") to return true, got false (RSpec::Expectations::ExpectationNotMetError)
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/02_validations/3">
<pre class="sh_ruby"><code>
require 'spec_helper'

describe BlogPost do

  it {should validate_presence_of :title}
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/02_validations/4">
<pre class="sh_ruby"><code>
group :test, :development do
  gem 'rspec-rails'
end

group :test do
  gem 'cucumber-rails'
  gem 'capybara'
  gem 'database_cleaner'
  gem 'shoulda-matchers'
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/02_validations/5">
<pre><code><code class="command">$ rake</code>
<code class="result">
1) BlogPost 
 Failure/Error: it {should validate_presence_of :title}
   Expected errors to include "can't be blank" when title is set to nil, got no errors
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="code/02_validations/6">
<pre class="sh_ruby"><code>
class BlogPost &lt; ActiveRecord::Base
  validates_presence_of :title
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="code/02_validations/7">
<pre><code><code class="command">$ rake</code>
<code class="result">
.

Finished in 0.02658 seconds
1 example, 0 failures

2 scenarios (2 passed)
8 steps (8 passed)
0m1.084s
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="java/01_java/1">
<h1>Java</h1>

<pre class="sh_java"><code>
package cukes;

import cuke4duke.annotation.I18n.EN.Given;

public class BlogPostSteps {

    @Given("^I write a blog post with title \\"([^\\"]*)\\" and body \\"([^\\"]*)\\"$")
    public void writeBlogPost (String title, String body) {

      ...

    }
}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="java/01_java/2">
<h1>Groovy</h1>

<pre class="sh_groovy"><code>
this.metaClass.mixin(cuke4duke.GroovyDsl)

Given(~/^I write a blog post with title "([^"]*)" and body "([^"]*)"$/) { String title, String body -&gt;
  ...
}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="thanks/thanks">
<h1>Thank You!</h1>

<p><img src="./file/thanks/valtech_logo.jpg" alt="Valtech"/></p></div>
</div></div>

</body>
</html>
